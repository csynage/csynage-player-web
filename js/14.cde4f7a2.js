(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"6cd2":function(e,o,i){"use strict";i.r(o);i("ddb0");var s,t,l=i("3a82"),n={name:"imgUploader",mixins:[l["a"]],props:{meta:{type:Object},prefixPath:{type:String}},computed:{isUploading(){return this.uploading},isBusy(){return this.uploading}},data(){return{uploading:!1,filesUploading:[],index:0}},methods:{abort(){},updateComponent(e,o,i="uploading"){const s=this.files[e],t="object"===typeof o?o.bytesTransferred:0;this.__updateFile(s,i,t)},upload(){if(!1===this.canUpload)return;this.uploading=!0;console.log("index:::",this.queuedFiles.length),this.queuedFiles.forEach((e=>{this.filesUploading.push(this.uploadFileToFirestore(e))})),Promise.all(this.filesUploading).then((()=>{this.uploading=!1})).catch((e=>{this.$q.notify({color:"negative",message:`One or more of your files failed to upload. ${e}`})}))},uploadFileToFirestore(e){console.log("=============>>>>>"),console.log("=============>>>>>"),console.log("=============>>>>>"),console.log("index:::0",this.filesUploading.length),console.log("index:::1",this.uploadedFiles.length);const{meta:o}=this,{userRef:i,storageRef:s}=this.$fb,t=this.index++,l=(e.type.split("/")[1],s(`${this.prefixPath}${e.name}`)),n=l.put(e),a=this.$fb.self().storage.TaskEvent.STATE_CHANGED;return console.log(`${this.prefixPath}${e.name}`),new Promise(((e,o)=>{n.on(a,(e=>{this.updateComponent(t,e)}),(e=>{this.$q.notify({color:"negative",message:`There was a problem with the upload. ${e}`}),this.updateComponent(t,0,"failed"),o()}),(()=>{this.uploadedFiles=this.uploadedFiles.concat(this.files),this.queuedFiles=[],this.filesUploading=[],this.files.forEach((async e=>{console.log(e.name),console.log(t),console.log(t),console.log(t),console.log(t),this.updateComponent(t,0,"uploaded");const o=await n.snapshot.ref.getDownloadURL();console.log({link:o}),console.log(o),this.$emit("uploaded",{files:[e.name]})})),e(this.file)}))}))}}},a=n,d=i("2877"),p=Object(d["a"])(a,s,t,!1,null,null,null);o["default"]=p.exports}}]);